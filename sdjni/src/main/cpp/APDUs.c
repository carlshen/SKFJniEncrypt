// APDUs.cpp: implementation of the APDUs class.
//
//////////////////////////////////////////////////////////////////////

#include "APDUs.h"

//CA环境FID
BYTE APDU_CA_FID[2] = { 0xDD, 0xF5 };    //CA环境FID
BYTE APDU_MF_FID[2] = { 0x3F, 0x00 };    //MF FID
BYTE APDU_EF01_FID[2] = { 0xEF, 0x01 };
BYTE APDU_EF02_FID[2] = { 0xEF, 0x02 };
//设备管理


//访问控制
//验证PIN码，0x05，包括管理员PIN和用户PIN
BYTE apdu_verifyPIN[0x05]  = { 0x00, 0x20, 0x00, 0x00, 0x00 };
//解锁PIN，0x05，在管理员验证后对用户PIN进行解锁
BYTE apdu_unblockPIN[0x05] = { 0x84, 0x24, 0x00, 0x00, 0x00 };
//修改PIN码，0x05，包括管理员PIN和用户PIN
BYTE apdu_changePIN[0x05]  = { 0x80, 0x5E, 0x01, 0x00, 0x00 };
//重装PIN，0x05，包括管理员PIN和用户PIN
BYTE apdu_reloadPIN[0x05]  = { 0x80, 0x5E, 0x01, 0x00, 0x00 };
//重装PIN时计算MAC的初始值，0x08
BYTE reload_initV[0x08] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
//重装PIN时计算MAC的密钥，0x08
BYTE reload_key[0x10]   = { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07 };

//应用管理
//设备
BYTE apdu_deviceKey[0x10] = { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 
                          0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10 
};
//验证TK，0x0D
BYTE apdu_verifyTK[0x40] = { 0x80, 0x82, 0x00, 0x01, 0x08 };
//传输密钥，0x10，创建MF时使用
BYTE apdu_TK[0x10] = { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F };
//选择MF，0x07，通过FID
BYTE apdu_selectMF[0x07] = { 0x00, 0xA4, 0x00, 0x00, 0x02, 0x3F, 0x00 };
//选择DF, 0x07，通过FID
BYTE apdu_selectDF[0x07] = { 0x00, 0xA4, 0x00, 0x00, 0x02, 0x00, 0x00 };
//创建DF，0x21
/*
BYTE apdu_createDF[0x21] = { 0x80, 0xE0, 0x00, 0x00, 0x1C, 
                             0x00, 0x00, //FID
							 0x80, 0x80, 0x80, 0x00, 0x00, //AC权限
							 0x00, //RFU
	                         0x0E, //AID Length
							 0x31, 0x50, 0x41, 0x59, 0x2E, 0x53, 0x59, 0x53, 0x2E, 0x44, 0x44, 0x46, 0x30, 0x31, 0xff, 0xff, //AID内容，不足0x10用0xFF填充
							 0x00, //MF文件类型
							 0x00, 0x00 //RFU
};
*/
//创建MF，0x21
/*
BYTE apdu_createMF[0x21] = { 0x80, 0xE0, 0x00, 0x00, 0x1C, 
                             0x3F, 0x00, //FID，固定位3F00
							 0x80, 0x80, 0x80, 0x00, //AC权限
							 0x00, 0x00, //RFU
	                         0x0E, //AID Length
							 0x31, 0x50, 0x41, 0x59, 0x2E, 0x53, 0x59, 0x53, 0x2E, 0x44, 0x44, 0x46, 0x30, 0x31, 0xff, 0xff, //AID内容，不足0x10用0xFF填充
							 0x00, //MF文件类型
							 0x00, 0x00 //RFU
};
*/
BYTE apdu_createDF[0x21] = { 0x80, 0xE0, 0x01, 0x00, 0x1C,
                             0xDF, 0x01,
							 0x40, 0x00, 0x00, 0x40,
							 0x00, 0x00,
							 0x09,
							 0xA0, 0x00, 0x00, 0x00, 0x03, 0x86, 0x98, 0x07, 0x01, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
							 0xE1,
							 0x00, 0x00 

};
//删除DF，0x05
BYTE apdu_deleteDF[0x05] = { 0x80, 0xE4, 0x00, 0x00, 0x00 };
//随机数，0x05
BYTE apdu_random[0x05] = { 0x00, 0x84, 0x00, 0x00, 0x10 };
//外部认证，0x0D
BYTE apdu_externalAuth[0x05] = { 0x00, 0x82, 0x00, 0x01, 0x08 };
//删除MF，0x07
BYTE apdu_deleteMF[0x07] = { 0x80, 0xE4, 0x00, 0x00, 0x02, 0x3F, 0x00 };
//外部认证密钥，0x10，删除MF时使用
BYTE apdu_TK2[0x10] = { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10 };

//创建KEY文件，0x19
BYTE apdu_createKey[0x19] = { 0x80, 0xe0, 0x04, 0x00, 0x14, 0x00, 0x00, 0x40, 0x40, 0x00, 0x00, 0x00, 0x00, 0x12, 0x03, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
//KEYMK密钥，0x10
BYTE apdu_KEYMK[0x10] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
//DAMK密钥，0x10
BYTE apdu_DAMK[0x10] = {  0x07, 0x45, 0x2A, 0x90, 0x55, 0x6D, 0x72, 0x2D, 0x40, 0x5F, 0x65, 0xC8, 0x96, 0xD7, 0x79, 0x1E };
//DCCK密钥，0x10
BYTE apdu_DCCK[0x10] = {  0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10 };
//DUPK密钥，0x10
BYTE apdu_DUPK[0x10] = { 0xCF, 0x7D, 0x9D, 0x37, 0xDF, 0x7E, 0xF5,0xC8, 0x95, 0xA3, 0xA1, 0xCE, 0x51, 0x03, 0x49, 0x6F };
//更新KEY文件，0x1C
//f 80D4010417 00010001330006 112233445566FFFFFFFFFFFFFFFFFFFF
BYTE apdu_writeKey[0x1C] = { 0x80, 0xD4, 0x01, 0x04, 0x17,
                             0x00, 0x01, 0x00, 0x01, 0x33, 0x00, 0x06,
							 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF
};

//KEYMK密钥，0x17
BYTE apdu_KEY_KEYMK[0x17] = { 0xFF, 0x01, 0x00, 0x01, 0x33, 0x90, 0x15,
	                      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 
};
//DAMK密钥，0x17
BYTE apdu_KEY_DAMK[0x17] = {  0x06, 0x01, 0x00, 0x01, 0x33, 0x90, 0x15,
	                      0x07, 0x45, 0x2A, 0x90, 0x55, 0x6D, 0x72, 0x2D, 0x40, 0x5F, 0x65, 0xC8, 0x96, 0xD7, 0x79, 0x1E 
};
 //DCCK密钥，0x17
BYTE apdu_KEY_DCCK[0x17] = {  0x09, 0x01, 0x00, 0x01, 0xFF, 0x80, 0x16,
	                      0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10 
};
//创建MF结束
BYTE apdu_createDFEnd[0x05] = { 0x80, 0xE0, 0x02, 0x00, 0x00};
//文件管理

//创建二进制，0x19
BYTE apdu_createBinary[0x19] = {  0x80, 0xe0, 0x03, 0x00, 0x14, 
                                  0xEF, 0x00, /*文件标识符*/
								  0x81, 0x40, /*读，写权限*/
								  0x00, 0x00, /*读写PIN权限，SM*/
								  0xff,       /*文件属性：00表示内部文件；FF表示外部文件*/
								  0x80,       /*SFI，初始值为0x00*/
								  0x01,       /*文件类型标识符，二进制文件*/
								  0x00,0x30,  /*文件大小，前为高字节，后为低字节*/
                                  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00  /*RFU*/
};
//读二进制文件
BYTE apdu_readBinary[0x05] = {0x00, 0xB0, 0x80, 0x00, 0x00 };
//更新二进制
BYTE apdu_updateBinary[0x05] = { 0x00, 0xD6, 0x80, 0x00, 0x00 };
//容器管理

//密码服务
//随机数，0x05
BYTE apdu_random2[0x05] = { 0x00, 0xE8, 0x00, 0x00, 0x00 };
//获取响应，0x05
BYTE apdu_getResponse[0x05] = { 0x00, 0xC0, 0x00, 0x00, 0x00 };

//ECC签名密钥对
BYTE apdu_eccGenKeyPair[0x05] = { 0x80, 0xCE, 0x00, 0x00, 0x40 };
BYTE apdu_eccSignData[0x05]   = { 0x80, 0xC2, 0x00, 0x00, 0x40 };
BYTE apdu_eccSignVerify[0x05] = { 0x80, 0xC4, 0x00, 0x00, 0x40 };
BYTE apdu_eccEncrypt[0x05]   = { 0x80, 0xC6, 0x00, 0x00, 0x40 };
BYTE apdu_eccDecrypt[0x05] = { 0x80, 0xC8, 0x00, 0x00, 0x40 };
//切换DDF3为个人化
BYTE apdu_personalization[0x05] = { 0x80, 0xe0, 0x02, 0x00, 0x00 };

//SM1，加密，ECB模式，0x05
BYTE apdu_encrypt_sm1_ecb[0x05] = { 0x80, 0xE2, 0x00, 0x00, 0x20 };
//SM1，解密，ECB模式，0x05
BYTE apdu_decrypt_sm1_ecb[0x05] = { 0x80, 0xEA, 0x00, 0x00, 0x20 };
//SM1，加密，CBC模式，0x05
BYTE apdu_encrypt_sm1_cbc[0x05] = { 0x80, 0xE2, 0x00, 0x01, 0x20 };
//SM1，解密，CBC模式，0x05
BYTE apdu_decrypt_sm1_cbc[0x05] = { 0x80, 0xEA, 0x00, 0x01, 0x20 };
//SM1，加密，CFB模式，0x05
BYTE apdu_encrypt_sm1_cfb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SM1，解密，CFB模式，0x05
BYTE apdu_decrypt_sm1_cfb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SM1，加密，OFB模式，0x05
BYTE apdu_encrypt_sm1_ofb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SM1，解密，OFB模式，0x05
BYTE apdu_decrypt_sm1_ofb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };

//SSF33，加密，ECB模式，0x05
BYTE apdu_encrypt_ssf33_ecb[0x05] = { 0x80, 0xE6, 0x00, 0x00, 0x20 };
//SSF33，解密，ECB模式，0x05
BYTE apdu_decrypt_ssf33_ecb[0x05] = { 0x80, 0xE8, 0x00, 0x00, 0x20 };
//SSF33，加密，CBC模式，0x05
BYTE apdu_encrypt_ssf33_cbc[0x05] = { 0x80, 0xE6, 0x00, 0x01, 0x20 };
//SSF33，解密，CBC模式，0x05
BYTE apdu_decrypt_ssf33_cbc[0x05] = { 0x80, 0xE8, 0x00, 0x01, 0x20 };
//SSF33，加密，CFB模式，0x05
BYTE apdu_encrypt_ssf33_cfb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SSF33，解密，CFB模式，0x05
BYTE apdu_decrypt_ssf33_cfb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SSF33，加密，OFB模式，0x05
BYTE apdu_encrypt_ssf33_ofb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SSF33，解密，OFB模式，0x05
BYTE apdu_decrypt_ssf33_ofb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };

//SM4，加密，ECB模式，0x05
BYTE apdu_encrypt_sm4_ecb[0x05] = { 0x80, 0xD2, 0x00, 0x00, 0x20 };
//SM4，解密，ECB模式，0x05
BYTE apdu_decrypt_sm4_ecb[0x05] = { 0x80, 0xD6, 0x00, 0x00, 0x20 };
//SM4，加密，CBC模式，0x05
BYTE apdu_encrypt_sm4_cbc[0x05] = { 0x80, 0xD2, 0x00, 0x01, 0x20 };
//SM4，解密，CBC模式，0x05
BYTE apdu_decrypt_sm4_cbc[0x05] = { 0x80, 0xD6, 0x00, 0x01, 0x20 };
//SM4，加密，CFB模式，0x05
BYTE apdu_encrypt_sm4_cfb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SM4，解密，CFB模式，0x05
BYTE apdu_decrypt_sm4_cfb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SM4，加密，OFB模式，0x05
BYTE apdu_encrypt_sm4_ofb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };
//SM4，解密，OFB模式，0x05
BYTE apdu_decrypt_sm4_ofb[0x05] = { 0x00, 0x00, 0x00, 0x00, 0x00 };

//分组算法SM1，SSF33和SM4等CBC模式使用，0x05
BYTE apdu_cbc_sendIV[0x05] = { 0x80, 0xD1, 0x00, 0x00, 0x10 };
//SM3杂凑
BYTE apdu_sm3_digest[0x05] = { 0x80, 0xB6, 0x00, 0x00, 0x40 };

//导入SM2签名密钥对
BYTE apdu_import_sm2_keypair[0x05] = { 0x80, 0xDE, 0x00, 0x00, 0x60 };
//点乘加运算
BYTE apdu_point_multadd[0x05] = { 0x80, 0xEC, 0x00, 0x00, 0x00 };
//模乘加运算
BYTE apdu_mod_multadd[0x05] = { 0x80, 0xEE, 0x00, 0x00, 0x00 };

